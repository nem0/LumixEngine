name: particle-tests
on:
  push:
    paths:
      - '**/particle_script*'
  pull_request:
    paths:
      - '**/particle_script*'

jobs:
  run-particle-tests:
    runs-on: windows-2022
    steps:
      - uses: actions/checkout@v2
      - name: CI diagnostics
        shell: cmd
        run: |
          echo == CI diagnostics ==
          echo CWD: %cd%
          echo PATH:
          echo %PATH%
          where msbuild.exe || echo msbuild.exe not found
          where genie.exe || echo genie.exe not found
          if exist "scripts\tmp\vs2022\LumixEngine.sln" (
            echo Solution exists: scripts\tmp\vs2022\LumixEngine.sln
          ) else (
            echo Solution missing; listing scripts\tmp
            dir scripts\tmp /s
          )
          echo Listing workspace root:
          dir /b
      - name: Run particle script tests
        shell: cmd
        run: |
          echo Running particle tests because particle_script* changed
          scripts\run_tests.bat
